imports:
  - { resource: services/field_file.yml }
  - { resource: services/field_image.yml }
  - { resource: services/image_style.yml }

parameters:
  gravity.file_manager.class:    Gravity\FileBundle\File\FileManager
  gravity.stream_wrapper_manager.class: Gravity\FileBundle\File\StreamWrapper\StreamWrapperManager

services:

  #
  # File Manager
  gravity.file_manager:
    class: %gravity.file_manager.class%
    arguments:
      - @gravity_cms.config_manager
      - @doctrine.orm.default_entity_manager
      - @gravity.stream_wrapper_manager

  #
  # Stream Wrapping
  gravity.stream_wrapper_manager:
    class: %gravity.stream_wrapper_manager.class%


  gravity.stream_wrapper.public:
    class: Gravity\FileBundle\File\StreamWrapper\Local\PublicStreamWrapper
    calls:
      - ['setDirPaths', [%kernel.root_dir%/../web/files, /files]]
    tags:
      - { name: gravity.stream_wrapper }


  #
  # Forms
  gravity.file.form.file_configuration:
    class: Gravity\FileBundle\Configuration\FileConfigurationForm
    arguments:
      - @gravity.stream_wrapper_manager
    tags:
      - { name: form.type, alias: file_configuration }

  gravity.file.form.gravity_file:
    class: Gravity\FileBundle\Form\GravityFileForm
    tags:
      - { name: form.type, alias: gravity_file }

  gravity.file.form.file_browser:
    class: Gravity\FileBundle\Form\Type\FileBrowserType
    tags:
      - { name: form.type, alias: file_browser }

  gravity.file.form.image_browser:
    class: Gravity\FileBundle\Form\Type\ImageBrowserType
    tags:
      - { name: form.type, alias: image_browser }

  gravity.file.form.file_collection:
    class: Gravity\FileBundle\Form\Type\FileCollectionType
    tags:
      - { name: form.type, alias: file_collection }
